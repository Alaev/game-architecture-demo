!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){var o;window,o=function(t){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=1)}([function(e,n){e.exports=t},function(t,e,n){"use strict";n.r(e);var o=function(t,e){var n=[];return t.forEach?t.forEach((function(t){e(t)&&n.push(t)})):Object.keys(t).forEach((function(o){e(t[o])&&n.push(t[o])})),n},i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a},r=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},a=function(){function t(t,e,n){void 0===e&&(e={}),void 0===n&&(n=[]),this.components=t,this.entities=e,this.array=n}return t.reset=function(){t.groups={}},t.generateGroupKey=function(t){for(var e=[],n=0;n<t.length;n++){var o=t[n];e.push(o)}return e.map((function(t){return t.toLowerCase()})).sort().join("-")},t.getGroup=function(e){var n=t.generateGroupKey(e);return t.groups[n]||{}},t.indexGroup=function(e,n){var i=[];i="string"==typeof e?[e]:e;var a,s=t.generateGroupKey(i);if(!t.groups[s])return a=t.groups[s]=new t(i),o(n,(function(t){t.hasComponents(i)&&(a.entities[t.id]=t,a.array=r(a.array,[t]))})),a},t.groups={},t}(),s=function(t,e){void 0===e&&(e=0);var n=e,o=t.length;if(o&&!(n>=o)){for(;n<o;)t[n]=t[n+1],n++;t.length--}},u=function(){function t(e){this.id=t.counter,this.constructor=e,this.components={},t.entities[this.id]=this,t.counter++}return t.reset=function(){o(t.entities,(function(t){t.destroy()})),a.reset()},t.getByComps=function(e,n){void 0===n&&(n="array");var o=e;a.indexGroup(e,t.entities);var i=a.getGroup(o);return"map"===n?i.entities:i.array.concat()},t.getByComp=function(e,n){return void 0===n&&(n="array"),t.getByComps([e])},t.prototype.assignGroup=function(t){t.entities[this.id]=this},t.prototype.addComponent=function(e){this.components[e.name]=e,this[e.name]=e;var n=[];for(var o in this.components)this.components.hasOwnProperty(o)&&n.push(o);for(var i in a.indexGroup(n,t.entities),a.groups)if(a.groups.hasOwnProperty(i)){var r=a.groups[i];if(!r.entities[this.id]&&-1!==r.components.indexOf(e.name)&&this.hasComponents(r.components)){this.assignGroup(r);var s=this.copyArray(r);r.array=this.extendGroup(s)}}},t.prototype.copyArray=function(t){return t.array},t.prototype.extendGroup=function(t){return t[t.length]=this,t},t.prototype.removeComponent=function(t){var e=this.components[t]||t,n=e.name;for(var o in a.groups)if(a.groups.hasOwnProperty(o)){var i=a.groups[o],r=i.components.indexOf(e.name)>-1,u=this.hasComponents(i.components);i.entities[this.id]&&r&&u&&(delete i.entities[this.id],s(i.array,i.array.indexOf(this)))}delete this.components[n],delete this[n]},t.prototype.destroy=function(){var e=this;Object.keys(this.components).forEach((function(t){e.removeComponent(e.components[t])})),delete t.entities[this.id]},t.prototype.normalizeToArray=function(t){return"string"==typeof t?[t]:t?t instanceof Array?t:void 0:[]},t.prototype.hasComponents=function(t){var e=this;return this.normalizeToArray(t),!!t&&("string"==typeof t?!!this.components[t]:t.reduce((function(t,n){return t&&!!e.components[n]}),!0))},t.counter=0,t.entities={},t}();window.Entity=u;var l,c=u,h=function(){function t(t,e){void 0===e&&(e=10),this.type=t,this.freePool=[],this.stats={free:0,used:0},this.incrementWhenEmpty=e}return t.prototype.reset=function(){this.freePool=[],this.stats={free:0,used:0}},t.prototype.generate=function(t){for(var e=t-this.stats.free>0?t-this.stats.free:0;e>0;)this.freePool.push(new this.type),e--;this.stats.free=this.freePool.length},t.prototype.acquire=function(){0===this.freePool.length&&this.generate(this.incrementWhenEmpty);var t=this.freePool.pop();return this.stats.free=this.freePool.length,t},t.prototype.release=function(t){-1===this.freePool.indexOf(t)&&(this.freePool.push(t),this.stats.free=this.freePool.length)},t}(),p=n(0),f=n.n(p),d=function(){function t(){this.reset()}return t.prototype.reset=function(){this.start={x:0,y:0},this.end={x:0,y:0}},t.prototype.getData=function(){return{start:Object.assign({},this.start),end:Object.assign({},this.end),width:this.getWidth(),height:this.getHeight()}},t.prototype.getHeight=function(){return this.end.y-this.start.y},t.prototype.getWidth=function(){return this.end.x-this.start.x},t.prototype.setStart=function(t,e){this.start.x=t,this.start.y=e},t.prototype.setEnd=function(t,e){this.end.x=t,this.end.y=e},t}(),y=function(t,e,n,o,i){return Math.pow(t-n,2)+Math.pow(e-o,2)<Math.pow(i,2)},v=function(t,e,n,o){var i=[];return t.forEach((function(t,r){if("selectedBox"!==r){var a=t.metaData||{},s=a.x,u=a.y,l=a.radius,c=a.width,h=a.height,p=a.type;"circle"===p&&y(n,o,s,u,l)?i.push({id:r,layerName:e}):"rect"!==p&&"image"!==p||n>=s&&n<=s+c&&o>=u&&o<=u+h&&i.push({id:r,layerName:e})}})),i},m=function(t,e,n){var o=Math.min(n.start.x,n.end.x),i=Math.max(n.start.x,n.end.x),r=Math.min(n.start.y,n.end.y),a=Math.max(n.start.y,n.end.y),s=[];return t.forEach((function(t,n){if("selectedBox"!==n){var u=t.metaData||{},l=u.x,c=u.y,h=(u.radius,u.width),p=u.height,f=u.type;if("circle"===f){var d=c;(y=l)>=o&&y<=i&&d>=r&&d<=a&&s.push({id:n,layerName:e})}else if("rect"===f||"image"===f){var y;d=c+p/2,(y=l+h/2)>=o&&y<=i&&d>=r&&d<=a&&s.push({id:n,layerName:e})}}})),s},M=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(t,e){void 0===e&&(e={}),this.draw=t,this.metaData=e},w=function(t){function e(e,n,o,i,r,a,s,u){var l=this,c={id:e,x:n,y:o,radius:i,type:"circle"};return(l=t.call(this,(function(){return l._draw()}),c)||this).metaData=c,l.id=e,l.ctx=u,l.x=n,l.y=o,l.radius=i,l.lineWidth=r,l.fillColor=a,l.color=s,l}return M(e,t),e.prototype._draw=function(){var t=this,e=t.ctx,n=t.lineWidth,o=t.x,i=t.y,r=t.radius,a=t.fillColor,s=t.color;e.strokeStyle=s,e.lineWidth=n,e.moveTo(o,i),e.beginPath(),e.arc(o,i,r,0,2*Math.PI),a&&(e.fillStyle=a,e.fill()),e.stroke(),e.closePath()},e}(g),x=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},C=function(){function t(t,e){if(void 0===e&&(e="white"),!t)throw"Cannot create layer, no initial context found";this.layers={initial:{ctx:t,shapes:new Map}},this.defaultStrokeStyle=e,t.strokeStyle=e}return t.prototype.addLayer=function(t){var e=this.layers.initial.ctx.canvas,n=e.parentNode,o=e.cloneNode();o.id=t,n.insertBefore(o,e),this.layers[t]={ctx:o.getContext("2d"),shapes:new Map}},t.prototype.removeLayer=function(t){this.layers.initial.ctx.canvas.parentNode.querySelector("#"+t).remove(),delete this.layers[t]},t.prototype.clear=function(t){void 0===t&&(t="initial"),this.layers[t].shapes=new Map},t.prototype.clearAllLayers=function(){for(var t in this.layers)this.layers.hasOwnProperty(t)&&this.clear(t)},t.prototype.remove=function(t,e){void 0===e&&(e="initial"),this.layers[e].shapes.delete(t)},t.prototype.addImage=function(t){var e=t.id,n=t.image,o=t.x,i=t.y,r=t.height,a=t.width,s=t.cropStartX,u=t.cropStartY,l=t.cropSizeX,c=t.cropSizeY,h=t.rotation,p=t.layerName,f=void 0===p?"initial":p,d=this.layers[f],y=d.ctx;d.shapes.set(e,new g((function(){y.beginPath(),y.save(),y.translate(o+a/2,i+r/2),y.rotate(h),y.drawImage(n,s,u,l,c,-a/2,-r/2,a,r),y.restore(),y.closePath()}),{id:e,type:"image",x:o,y:i,height:r,width:a}))},t.prototype.addShape=function(t){var e=t.id,n=t.drawFn,o=t.layerName,i=void 0===o?"initial":o,r=this.layers[i],a=r.ctx;r.shapes.set(e,new g((function(){n(a)})))},t.prototype.writeBubble=function(t){var e=t.id,n=t.text,o=t.backgroundColor,i=t.borderColor,r=t.borderWidth,a=t.fontSize,s=t.fontColor,u=t.x,l=t.y,c=t.fontFace,h=t.height,p=t.width,f=t.paddingLeft,d=void 0===f?10:f,y=t.paddingTop,v=void 0===y?10:y,m=t.layerName,M=void 0===m?"initial":m,g=0,w=n.split("\n"),x=a||+this.layers.initial.ctx.font.split("px")[0],C=c||+this.layers.initial.ctx.font.split("px")[1];this.layers.initial.ctx.font=x+"px "+C;for(var P=0;P<w.length;P++){var b=this.layers[M].ctx.measureText(w[P]).width;g=b>g?b:g}for(this.addRect({id:""+e,x:u,y:l,height:Math.max(h,w.length*x+2*v),width:Math.max(p,g+2*d+r),fillColor:o,lineWidth:r,strokeStyle:i,layerName:M}),P=0;P<w.length;P++)this.write({id:e+"-bubbleText-"+P,text:w[P],x:u+d,y:l+x+v+P*x,fillStyle:s,font:x+"px "+C,layerName:M,textBaseline:null,strokeStyle:null})},t.prototype.addRect=function(t){var e=t.id,n=t.x,o=t.y,i=t.width,r=t.height,a=t.strokeStyle,s=t.lineWidth,u=t.fillColor,l=t.layerName,c=void 0===l?"initial":l,h=this.layers[c];if(!h)throw"Could not find layer '"+c+"', are you sure you created the layer?";var p=h.ctx;h.shapes.set(e,new g((function(){p.strokeStyle=a,p.lineWidth=s,p.beginPath(),p.rect(n,o,i,r),u&&(p.fillStyle=u,p.fill()),p.stroke(),p.closePath()}),{id:e,type:"rect",x:n,y:o,height:r,width:i}))},t.prototype.addArc=function(t){var e=t.id,n=t.direction,o=t.size,i=t.color,r=void 0===i?"black":i,a=t.fillColor,s=t.lineWidth,u=void 0===s?1:s,l=t.x,c=t.y,h=t.radius,p=t.layerName,f=void 0===p?"initial":p,d=this.layers[f],y=d.ctx;d.shapes.set(e,new g((function(){y.strokeStyle=r,y.lineWidth=u;var t=n-o/2,e=n+o/2;y.beginPath(),y.arc(l,c,h,t*Math.PI,e*Math.PI),a&&(y.fillStyle=a,y.fill()),y.stroke(),y.closePath()})))},t.prototype.addCircle=function(t){var e=t.id,n=t.x,o=t.y,i=t.radius,r=t.lineWidth,a=t.color,s=t.fillColor,u=t.layerName,l=void 0===u?"initial":u,c=this.layers[l],h=c.ctx;c.shapes.set(e,new w(e,n,o,i,r,s,a,h))},t.prototype.pan=function(t,e){for(var n in this.panX=t,this.panY=e,this.layers)this.layers.hasOwnProperty(n)&&(this.layers[n].ctx.setTransform(1,0,0,1,t,e),"initial"!==n&&this.draw(n))},t.prototype.getPan=function(){return{panX:this.panX||0,panY:this.panY||0}},t.prototype.write=function(t){var e=t.id,n=t.text,o=t.x,i=t.y,r=t.font,a=void 0===r?"":r,s=t.textBaseline,u=t.fillStyle,l=t.strokeStyle,c=void 0===l?"":l,h=t.layerName,p=void 0===h?"initial":h,f=this.layers[p],d=f.ctx;f.shapes.set(e,new g((function(){d.beginPath(),d.font=a,d.textBaseline=s,d.fillStyle=u,d.strokeStyle=c,d.fillText(n,o,i),d.closePath()}),{id:e,x:o,y:i}))},t.prototype.draw=function(t){var e,n;void 0===t&&(t="initial");var o=this.layers[t],i=o.ctx,r=o.shapes;i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,i.canvas.width,i.canvas.height),i.restore();try{for(var a=x(r.values()),s=a.next();!s.done;s=a.next())s.value.draw(),i.strokeStyle=this.defaultStrokeStyle}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}},t}(),P=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a},b=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(P(arguments[e]));return t},S=function(){function t(t){var e=this,n=function(){};this.selectedBoxColor=t.selectedBoxColor||"blue",this.mapHeight=t.mapHeight,this.mapWidth=t.mapWidth,this.viewHeight=t.viewHeight,this.viewWidth=t.viewWidth,this.onViewMapClick=t.onViewMapClick||n,this.onViewMapMove=t.onViewMapMove||n,this.onMiniMapClick=t.onMiniMapClick||n,this.onMiniMapMove=t.onMiniMapMove||n,this.enableSelectBox=t.enableSelectBox,this.lastClick=0,this.isMouseDown=!1,this.dbClick=!1,this.lastTap=0,this.selectedBox=new d,["updateViewMapCursorPosition","updateMiniMapCursorPosition","handleMapMouseUp","handleMapMouseDown","handleMapMouseDown","handleMiniMapClick","handleMiniMapMove","handleMapMouseMove","handleMapMouseLeave","handleTouchMove","handleTouchStart","handleMapTouchEnd","handleMiniMapTouchStart"].forEach((function(t){e[t]=e[t].bind(e)}))}return t.prototype.getCursorPositionInCanvasTerms=function(t,e,n){var o=e.getBoundingClientRect();if("number"!=typeof t.x||"number"!=typeof t.y)throw"Invalid inputCoordinates provided, missing X or Y";var i=t.x-o.left,r=t.y-o.top,a=e.width/o.width,s=e.height/o.height,u=Math.max(0,Math.round(i*a)),l=Math.max(0,Math.round(r*s));return{x:u-n.getPan().panX,y:l-n.getPan().panY}},t.prototype.handleMapMouseMove=function(){if(this.isMouseDown){if(!1===this.enableSelectBox)return;this.selectedBox.setEnd(this.lastKnownPositionInCanvasTermsX,this.lastKnownPositionInCanvasTermsY);var t=this.selectedBox.getData();this.mapAPI.addRect({id:"selectedBox",x:t.start.x,y:t.start.y,width:t.width,height:t.height,strokeStyle:this.selectedBoxColor,lineWidth:1,layerName:"initial",fillColor:null})}this.onViewMapMove({x:this.lastKnownPositionInCanvasTermsX,y:this.lastKnownPositionInCanvasTermsY,isMouseDown:this.isMouseDown,dbClick:this.dbClick,selectedBox:this.selectedBox.getData()})},t.prototype.handleMapMouseLeave=function(){this.isMouseDown&&this.handleMapMouseUp()},t.prototype.handleMapTouchEnd=function(){var t=this;this.isMouseDown=!1;var e=this.selectedBox.getData(),n=Object.keys(this.mapAPI.layers),o=[];n.forEach((function(n){if(e.end.x===e.start.x){var i=t.lastKnownPositionInCanvasTermsX,r=t.lastKnownPositionInCanvasTermsY;o=b(o,v(t.mapAPI.layers[n].shapes,n,i,r))}else o=b(o,m(t.mapAPI.layers[n].shapes,n,e))})),this.mapAPI.addRect({fillColor:null,layerName:"initial",lineWidth:1,strokeStyle:null,id:"selectedBox",x:0,y:0,width:0,height:0}),this.onViewMapClick({x:this.lastKnownPositionInCanvasTermsX,y:this.lastKnownPositionInCanvasTermsY,isMouseDown:this.isMouseDown,dbClick:this.dbTap||this.dbClick,selectedBox:e,hits:o}),this.selectedBox.reset()},t.prototype.handleMapMouseUp=function(){this.lastTap||this.handleMapTouchEnd()},t.prototype.updateViewMapCursorPosition=function(t){var e=this.getCursorPositionInCanvasTerms(t,this.viewMapCanvas,this.mapAPI),n=e.x,o=e.y;return this.lastKnownPositionInCanvasTermsX=n,this.lastKnownPositionInCanvasTermsY=o,{x:n,y:o}},t.prototype.updateMiniMapCursorPosition=function(t){var e=this.getCursorPositionInCanvasTerms(t,this.miniMapCanvas,this.miniMapAPI),n=e.x,o=e.y;this.miniMapX=n,this.miniMapY=o},t.prototype.getNewCanvasPairs=function(t){var e=t.getMapRef,n=t.getMiniRef;return{map:this.generateMapCanvas(e),minimap:this.generateMiniMapCanvas(n)}},t.prototype.handleMiniMapMove=function(t){this.onMiniMapMove(t)},t.prototype.handleMiniMapClick=function(t){var e=this.miniMapX,n=this.miniMapY,o=Math.max(e-this.viewWidth/2,0),i=Math.max(n-this.viewHeight/2,0),r=this.mapWidth,a=this.mapHeight;o=o+this.viewWidth<r?o:r-this.viewWidth,i=i+this.viewHeight<a?i:a-this.viewHeight,this.mapAPI.pan(-o,-i),this.updateMiniMapSquare(),this.onMiniMapClick(t)},t.prototype.updateMiniMapSquare=function(){this.miniMapAPI.addRect({fillColor:null,layerName:"initial",id:"currentMap",x:-this.mapAPI.getPan().panX,y:-this.mapAPI.getPan().panY,width:this.viewWidth,height:this.viewHeight,strokeStyle:"green",lineWidth:20})},t.prototype.handleMapMouseDown=function(){if(!this.lastTap){var t=(new Date).getTime();this.dbClick=t-this.lastClick<300,this.lastClick=t,this.isMouseDown=!0,this.setSelectBox()}},t.prototype.setSelectBox=function(){!1!==this.enableSelectBox&&(this.selectedBox.setStart(this.lastKnownPositionInCanvasTermsX,this.lastKnownPositionInCanvasTermsY),this.selectedBox.setEnd(this.lastKnownPositionInCanvasTermsX,this.lastKnownPositionInCanvasTermsY))},t.prototype.handleTouchStart=function(t){var e={x:t.touches[0].clientX,y:t.touches[0].clientY};this.updateViewMapCursorPosition(e);var n=this.getCursorPositionInCanvasTerms(e,this.viewMapCanvas,this.mapAPI),o=(n.x,n.y,(new Date).getTime());this.dbTap=o-this.lastTap<300,this.lastTap=o,this.setSelectBox()},t.prototype.handleMiniMapTouchStart=function(t){var e={x:t.touches[0].clientX,y:t.touches[0].clientY},n=this.getCursorPositionInCanvasTerms(e,this.miniMapCanvas,this.miniMapAPI),o=n.x,i=n.y;this.miniMapX=o,this.miniMapY=i,this.handleMiniMapClick(t)},t.prototype.ensureNegative=function(t){return Math.min(t,0)},t.prototype.handleTouchMove=function(t){t.preventDefault();var e={x:t.touches[0].clientX,y:t.touches[0].clientY},n=this.getCursorPositionInCanvasTerms(e,this.viewMapCanvas,this.mapAPI),o=n.x,i=n.y,r=this.mapAPI.getPan(),a=r.panX,s=r.panY,u=a+(o-this.lastKnownPositionInCanvasTermsX),l=s+(i-this.lastKnownPositionInCanvasTermsY),c=u+this.viewWidth<this.mapWidth,h=l+this.viewWidth<this.mapHeight,p=this.viewWidth-this.mapWidth,f=this.viewHeight-this.mapHeight,d=c?u:p,y=h?l:f;this.mapAPI.pan(this.ensureNegative(d),this.ensureNegative(y))},t.prototype.generateMapCanvas=function(t){var e=this;return f.a.createElement("canvas",{className:"viewMap",ref:function(n){if(!n)return null;e.viewMapCanvas=n,document.removeEventListener("mousemove",e.updateViewMapCursorPosition),document.addEventListener("mousemove",e.updateViewMapCursorPosition),n.removeEventListener("touchmove",e.handleTouchMove,!1),n.addEventListener("touchmove",e.handleTouchMove,!1),e.mapAPI=new C(n.getContext("2d")),t(e.mapAPI,n)},height:this.viewHeight,width:this.viewWidth,onMouseDown:this.handleMapMouseDown,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleMapTouchEnd,onMouseMove:this.handleMapMouseMove,onMouseUp:this.handleMapMouseUp,onMouseLeave:this.handleMapMouseLeave})},t.prototype.generateMiniMapCanvas=function(t){var e=this;return f.a.createElement("canvas",{className:"minimap",ref:function(n){if(!n)return null;e.miniMapCanvas=n,document.removeEventListener("mousemove",e.updateMiniMapCursorPosition),document.addEventListener("mousemove",e.updateMiniMapCursorPosition),e.miniMapAPI=new C(n.getContext("2d"));var o=setInterval((function(){e.mapAPI&&(e.updateMiniMapSquare(),clearInterval(o))}),100);t(e.miniMapAPI,n)},height:this.mapHeight,width:this.mapWidth,onMouseMove:this.handleMiniMapMove,onMouseDown:this.handleMiniMapClick,onTouchStart:this.handleMiniMapTouchStart})},t}(),I=function(){function t(){this.systems=[],this.frameID=null}return t.prototype.addSystem=function(t){this.systems.push(t)},t.prototype.run=function(t){var e=this;return this.frameID=requestAnimationFrame((function(){e.run(t);var n="function"==typeof t?t():t;e.runSystems(n)})),this.frameID},t.prototype.runSystems=function(t){for(var e=0;e<this.systems.length;e++)this.systems[e](t)},t.prototype.stop=function(){return cancelAnimationFrame(this.frameID),this.frameID},t}();n.d(e,"Entity",(function(){return c})),n.d(e,"entityLoop",(function(){return o})),n.d(e,"ObjectPool",(function(){return h})),n.d(e,"GameCanvas",(function(){return S})),n.d(e,"Engine",(function(){return I})),e.default={Entity:c,entityLoop:o,ObjectPool:h,GameCanvas:S,Engine:I}}])},t.exports=o(n(1))},function(t,e,n){"use strict";t.exports=n(2)},function(t,e,n){"use strict";
/** @license React v16.8.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o=n(3),i="function"==typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.concurrent_mode"):60111,f=i?Symbol.for("react.forward_ref"):60112,d=i?Symbol.for("react.suspense"):60113,y=i?Symbol.for("react.memo"):60115,v=i?Symbol.for("react.lazy"):60116,m="function"==typeof Symbol&&Symbol.iterator;function M(t,e,n,o,i,r,a,s){if(!t){if(t=void 0,void 0===e)t=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,o,i,r,a,s],l=0;(t=Error(e.replace(/%s/g,(function(){return u[l++]})))).name="Invariant Violation"}throw t.framesToPop=1,t}}function g(t){for(var e=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,o=0;o<e;o++)n+="&args[]="+encodeURIComponent(arguments[o+1]);M(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x={};function C(t,e,n){this.props=t,this.context=e,this.refs=x,this.updater=n||w}function P(){}function b(t,e,n){this.props=t,this.context=e,this.refs=x,this.updater=n||w}C.prototype.isReactComponent={},C.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&g("85"),this.updater.enqueueSetState(this,t,e,"setState")},C.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},P.prototype=C.prototype;var S=b.prototype=new P;S.constructor=b,o(S,C.prototype),S.isPureReactComponent=!0;var I={current:null},O={current:null},T=Object.prototype.hasOwnProperty,E={key:!0,ref:!0,__self:!0,__source:!0};function k(t,e,n){var o=void 0,i={},a=null,s=null;if(null!=e)for(o in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)T.call(e,o)&&!E.hasOwnProperty(o)&&(i[o]=e[o]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(o in u=t.defaultProps)void 0===i[o]&&(i[o]=u[o]);return{$$typeof:r,type:t,key:a,ref:s,props:i,_owner:O.current}}function N(t){return"object"==typeof t&&null!==t&&t.$$typeof===r}var _=/\/+/g,j=[];function A(t,e,n,o){if(j.length){var i=j.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=o,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:o,count:0}}function D(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>j.length&&j.push(t)}function B(t,e,n){return null==t?0:function t(e,n,o,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case a:u=!0}}if(u)return o(i,e,""===n?"."+W(e,0):n),1;if(u=0,n=""===n?".":n+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c=n+W(s=e[l],l);u+=t(s,c,o,i)}else if(null===e||"object"!=typeof e?c=null:c="function"==typeof(c=m&&e[m]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=t(s=s.value,c=n+W(s,l++),o,i);else"object"===s&&g("31","[object Object]"===(o=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":o,"");return u}(t,"",e,n)}function W(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function R(t,e){t.func.call(t.context,e,t.count++)}function L(t,e,n){var o=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?Y(t,o,n,(function(t){return t})):null!=t&&(N(t)&&(t=function(t,e){return{$$typeof:r,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(_,"$&/")+"/")+n)),o.push(t))}function Y(t,e,n,o,i){var r="";null!=n&&(r=(""+n).replace(_,"$&/")+"/"),B(t,L,e=A(e,r,o,i)),D(e)}function X(){var t=I.current;return null===t&&g("307"),t}var $={Children:{map:function(t,e,n){if(null==t)return t;var o=[];return Y(t,o,null,e,n),o},forEach:function(t,e,n){if(null==t)return t;B(t,R,e=A(null,null,e,n)),D(e)},count:function(t){return B(t,(function(){return null}),null)},toArray:function(t){var e=[];return Y(t,e,null,(function(t){return t})),e},only:function(t){return N(t)||g("143"),t}},createRef:function(){return{current:null}},Component:C,PureComponent:b,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:f,render:t}},lazy:function(t){return{$$typeof:v,_ctor:t,_status:-1,_result:null}},memo:function(t,e){return{$$typeof:y,type:t,compare:void 0===e?null:e}},useCallback:function(t,e){return X().useCallback(t,e)},useContext:function(t,e){return X().useContext(t,e)},useEffect:function(t,e){return X().useEffect(t,e)},useImperativeHandle:function(t,e,n){return X().useImperativeHandle(t,e,n)},useDebugValue:function(){},useLayoutEffect:function(t,e){return X().useLayoutEffect(t,e)},useMemo:function(t,e){return X().useMemo(t,e)},useReducer:function(t,e,n){return X().useReducer(t,e,n)},useRef:function(t){return X().useRef(t)},useState:function(t){return X().useState(t)},Fragment:s,StrictMode:u,Suspense:d,createElement:k,cloneElement:function(t,e,n){null==t&&g("267",t);var i=void 0,a=o({},t.props),s=t.key,u=t.ref,l=t._owner;if(null!=e){void 0!==e.ref&&(u=e.ref,l=O.current),void 0!==e.key&&(s=""+e.key);var c=void 0;for(i in t.type&&t.type.defaultProps&&(c=t.type.defaultProps),e)T.call(e,i)&&!E.hasOwnProperty(i)&&(a[i]=void 0===e[i]&&void 0!==c?c[i]:e[i])}if(1===(i=arguments.length-2))a.children=n;else if(1<i){c=Array(i);for(var h=0;h<i;h++)c[h]=arguments[h+2];a.children=c}return{$$typeof:r,type:t.type,key:s,ref:u,props:a,_owner:l}},createFactory:function(t){var e=k.bind(null,t);return e.type=t,e},isValidElement:N,version:"16.8.2",unstable_ConcurrentMode:p,unstable_Profiler:l,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:I,ReactCurrentOwner:O,assign:o}},K={default:$},H=K&&$||K;t.exports=H.default||H},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(t){o[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,u=a(t),l=1;l<arguments.length;l++){for(var c in n=Object(arguments[l]))i.call(n,c)&&(u[c]=n[c]);if(o){s=o(n);for(var h=0;h<s.length;h++)r.call(n,s[h])&&(u[s[h]]=n[s[h]])}}return u}},function(t,e,n){"use strict";n.r(e);var o=n(0);var i=class{constructor(t){this.name="SPEED",this.speed=t}};var r=class{constructor(t,e){this.name="POSITION",this.x=t,this.y=e}};var a=class{constructor(t="green"){this.color=t,this.name="COLOR"}};var s=class{constructor(){this.name="PLAYER"}};class u extends o.Entity{constructor(t,e){super(u),this.addComponent(new r(t,e)),this.addComponent(new i(5)),this.addComponent(new a("green")),this.addComponent(new s)}}var l=u;var c=class{constructor(t,e){this.name="DESTINATION",this.x=t,this.y=e}};var h=function(){Entity.getByComps(["POSITION","COLOR"]).forEach(t=>{let{x:e,y:n}=t.components.POSITION,{color:o}=t.components.COLOR;window.drawCircle(e,n,o)})};var p=function(){o.Entity.getByComps(["SPEED","DESTINATION","POSITION"]).forEach(t=>{let{x:e,y:n}=t.components.POSITION,{x:o,y:i}=t.components.DESTINATION,{speed:r}=t.components.SPEED;e<o?t.components.POSITION.x+=r:t.components.POSITION.x-=r,n<i?t.components.POSITION.y+=r:t.components.POSITION.y-=r})};var f=class{constructor(){this.name="AI"}};class d extends o.Entity{constructor(t,e){super(d),this.addComponent(new r(t,e)),this.addComponent(new i(1)),this.addComponent(new a("red")),this.addComponent(new f)}}var y=d;var v=function(){let t=o.Entity.getByComps(["PLAYER","POSITION"])[0],{x:e,y:n}=t.components.POSITION;o.Entity.getByComps(["AI"]).forEach(t=>{t.hasComponents(["DESTINATION"])?(t.components.DESTINATION.x=e,t.components.DESTINATION.y=n):t.addComponent(new c(e,n))})};let m=new l(50,50);new y(0,0),window.canvas.addEventListener("mousemove",t=>{m.hasComponents(["DESTINATION"])?(m.components.DESTINATION.x=t.x,m.components.DESTINATION.y=t.y):m.addComponent(new c(t.x,t.y))}),setInterval(()=>{window.ctx.clearRect(0,0,500,500),p(),h(),v()},16)}]);